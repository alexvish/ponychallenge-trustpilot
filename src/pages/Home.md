# Solution to trustpilot pony challenge

This is complete solution to trustpilot's [pony challenge](https://ponychallenge.trustpilot.com/index.html).
You will enjoy it if you are above 35 and still live with your mom.

## The task
Trustpilot provides game api [(swagger)](https://ponychallenge.trustpilot.com/api-docs/index.html#/pony-challenge) that 
allows you to create maze, and then direct pony to exit. 
Domokun (monster) chases the pony. 
If pony reaches the exit, you win, if Domokun overtakes pony you loose.

The maze that is generated by api _looks_ to be a prefect maze, which means there is one and only one path between any of two cells.
This means that when both pony and domokun make prefect moves (which is realized on difficulty level 10) then
it is wholy determined by initial position whether player looses or wins. 
Also, in non-prefect mazes there could be a "cycles" that can be used by pony to fool domokun.

But the maze is prefect, so for this game I use this strategy:
1. Calculate path from pony location to exit `exitPath`
2. Follow the exit path until exit is reached or next cell on exit path is either occupied by domokun, or within 
   domokuns one step range.
3. In the later case calculate the longest possible route that pony can follow within maze `exitRoute`, and follow
   `exitRoute`, adding the current Pony cell to the end of `exitPath`. If the next point on `exitPath` become
   out of reach for domokun (he makes wrong move), forget escape route and follow the exit path.
  
Here are the pictures:

Exit Path (green):

<svg width="580" height="520"><text x="50" y="20" class="marker">0</text><text x="80" y="20" class="marker">1</text><text x="110" y="20" class="marker">2</text><text x="140" y="20" class="marker">3</text><text x="170" y="20" class="marker">4</text><text x="200" y="20" class="marker">5</text><text x="230" y="20" class="marker">6</text><text x="260" y="20" class="marker">7</text><text x="290" y="20" class="marker">8</text><text x="320" y="20" class="marker">9</text><text x="350" y="20" class="marker">10</text><text x="380" y="20" class="marker">11</text><text x="410" y="20" class="marker">12</text><text x="440" y="20" class="marker">13</text><text x="470" y="20" class="marker">14</text><text x="500" y="20" class="marker">15</text><text x="530" y="20" class="marker">16</text><text x="20" y="50" class="marker">0</text><text x="20" y="80" class="marker">1</text><text x="20" y="110" class="marker">2</text><text x="20" y="140" class="marker">3</text><text x="20" y="170" class="marker">4</text><text x="20" y="200" class="marker">5</text><text x="20" y="230" class="marker">6</text><text x="20" y="260" class="marker">7</text><text x="20" y="290" class="marker">8</text><text x="20" y="320" class="marker">9</text><text x="20" y="350" class="marker">10</text><text x="20" y="380" class="marker">11</text><text x="20" y="410" class="marker">12</text><text x="20" y="440" class="marker">13</text><text x="20" y="470" class="marker">14</text><rect x="35" y="35" width="30" height="30" class="cell walls-11"></rect><rect x="65" y="35" width="30" height="30" class="cell walls-11"></rect><rect x="95" y="35" width="30" height="30" class="cell walls-3"></rect><rect x="125" y="35" width="30" height="30" class="cell walls-5"></rect><rect x="155" y="35" width="30" height="30" class="cell walls-5"></rect><rect x="185" y="35" width="30" height="30" class="cell walls-5"></rect><rect x="215" y="35" width="30" height="30" class="cell walls-5"></rect><rect x="245" y="35" width="30" height="30" class="cell walls-5"></rect><rect x="275" y="35" width="30" height="30" class="cell walls-5"></rect><rect x="305" y="35" width="30" height="30" class="cell walls-9"></rect><rect x="335" y="35" width="30" height="30" class="cell walls-3 cell-exit"></rect><rect x="365" y="35" width="30" height="30" class="cell walls-5 cell-exit"></rect><rect x="395" y="35" width="30" height="30" class="cell walls-5 cell-exit"></rect><rect x="425" y="35" width="30" height="30" class="cell walls-1 cell-exit"></rect><rect x="455" y="35" width="30" height="30" class="cell walls-5"></rect><rect x="485" y="35" width="30" height="30" class="cell walls-5"></rect><rect x="515" y="35" width="30" height="30" class="cell walls-9"></rect><rect x="35" y="65" width="30" height="30" class="cell walls-10"></rect><rect x="65" y="65" width="30" height="30" class="cell walls-6"></rect><rect x="95" y="65" width="30" height="30" class="cell walls-4"></rect><rect x="125" y="65" width="30" height="30" class="cell walls-5"></rect><rect x="155" y="65" width="30" height="30" class="cell walls-5"></rect><rect x="185" y="65" width="30" height="30" class="cell walls-13"></rect><rect x="215" y="65" width="30" height="30" class="cell walls-3"></rect><rect x="245" y="65" width="30" height="30" class="cell walls-5"></rect><rect x="275" y="65" width="30" height="30" class="cell walls-9"></rect><rect x="305" y="65" width="30" height="30" class="cell walls-2 cell-exit"></rect><rect x="335" y="65" width="30" height="30" class="cell walls-12 cell-exit"></rect><rect x="365" y="65" width="30" height="30" class="cell walls-7"></rect><rect x="395" y="65" width="30" height="30" class="cell walls-9"></rect><rect x="425" y="65" width="30" height="30" class="cell walls-6 cell-exit"></rect><rect x="455" y="65" width="30" height="30" class="cell walls-9 cell-exit"></rect><rect x="485" y="65" width="30" height="30" class="cell walls-3"></rect><rect x="515" y="65" width="30" height="30" class="cell walls-12"></rect><rect x="35" y="95" width="30" height="30" class="cell walls-10"></rect><rect x="65" y="95" width="30" height="30" class="cell walls-3"></rect><rect x="95" y="95" width="30" height="30" class="cell walls-5"></rect><rect x="125" y="95" width="30" height="30" class="cell walls-5"></rect><rect x="155" y="95" width="30" height="30" class="cell walls-5"></rect><rect x="185" y="95" width="30" height="30" class="cell walls-9"></rect><rect x="215" y="95" width="30" height="30" class="cell walls-10"></rect><rect x="245" y="95" width="30" height="30" class="cell walls-7"></rect><rect x="275" y="95" width="30" height="30" class="cell walls-8"></rect><rect x="305" y="95" width="30" height="30" class="cell walls-6 cell-exit"></rect><rect x="335" y="95" width="30" height="30" class="cell walls-5 cell-exit"></rect><rect x="365" y="95" width="30" height="30" class="cell walls-9 cell-exit"></rect><rect x="395" y="95" width="30" height="30" class="cell walls-10"></rect><rect x="425" y="95" width="30" height="30" class="cell walls-3 cell-exit"></rect><rect x="455" y="95" width="30" height="30" class="cell walls-12 cell-exit"></rect><rect x="485" y="95" width="30" height="30" class="cell walls-6"></rect><rect x="515" y="95" width="30" height="30" class="cell walls-13"></rect><rect x="35" y="125" width="30" height="30" class="cell walls-10"></rect><rect x="65" y="125" width="30" height="30" class="cell walls-6"></rect><rect x="95" y="125" width="30" height="30" class="cell walls-9"></rect><rect x="125" y="125" width="30" height="30" class="cell walls-3"></rect><rect x="155" y="125" width="30" height="30" class="cell walls-9"></rect><rect x="185" y="125" width="30" height="30" class="cell walls-10"></rect><rect x="215" y="125" width="30" height="30" class="cell walls-6"></rect><rect x="245" y="125" width="30" height="30" class="cell walls-9"></rect><rect x="275" y="125" width="30" height="30" class="cell walls-6"></rect><rect x="305" y="125" width="30" height="30" class="cell walls-9"></rect><rect x="335" y="125" width="30" height="30" class="cell walls-3"></rect><rect x="365" y="125" width="30" height="30" class="cell walls-12 cell-exit"></rect><rect x="395" y="125" width="30" height="30" class="cell walls-10"></rect><rect x="425" y="125" width="30" height="30" class="cell walls-6 cell-exit"></rect><rect x="455" y="125" width="30" height="30" class="cell walls-5 cell-exit"></rect><rect x="485" y="125" width="30" height="30" class="cell walls-5 cell-exit"></rect><rect x="515" y="125" width="30" height="30" class="cell walls-9 cell-exit"></rect><rect x="35" y="155" width="30" height="30" class="cell walls-6"></rect><rect x="65" y="155" width="30" height="30" class="cell walls-9"></rect><rect x="95" y="155" width="30" height="30" class="cell walls-10"></rect><rect x="125" y="155" width="30" height="30" class="cell walls-10"></rect><rect x="155" y="155" width="30" height="30" class="cell walls-10"></rect><rect x="185" y="155" width="30" height="30" class="cell walls-6"></rect><rect x="215" y="155" width="30" height="30" class="cell walls-9"></rect><rect x="245" y="155" width="30" height="30" class="cell walls-6"></rect><rect x="275" y="155" width="30" height="30" class="cell walls-9"></rect><rect x="305" y="155" width="30" height="30" class="cell walls-10"></rect><rect x="335" y="155" width="30" height="30" class="cell walls-6"></rect><rect x="365" y="155" width="30" height="30" class="cell walls-1"></rect><rect x="395" y="155" width="30" height="30" class="cell walls-12"></rect><rect x="425" y="155" width="30" height="30" class="cell walls-3 cell-exit"></rect><rect x="455" y="155" width="30" height="30" class="cell walls-5 cell-exit"></rect><rect x="485" y="155" width="30" height="30" class="cell walls-9 cell-exit"></rect><rect x="515" y="155" width="30" height="30" class="cell walls-10 cell-exit"></rect><rect x="35" y="185" width="30" height="30" class="cell walls-11"></rect><rect x="65" y="185" width="30" height="30" class="cell walls-10"></rect><rect x="95" y="185" width="30" height="30" class="cell walls-6"></rect><rect x="125" y="185" width="30" height="30" class="cell walls-12"></rect><rect x="155" y="185" width="30" height="30" class="cell walls-6"></rect><rect x="185" y="185" width="30" height="30" class="cell walls-9"></rect><rect x="215" y="185" width="30" height="30" class="cell walls-6"></rect><rect x="245" y="185" width="30" height="30" class="cell walls-5"></rect><rect x="275" y="185" width="30" height="30" class="cell walls-12"></rect><rect x="305" y="185" width="30" height="30" class="cell walls-10"></rect><rect x="335" y="185" width="30" height="30" class="cell walls-7"></rect><rect x="365" y="185" width="30" height="30" class="cell walls-12"></rect><rect x="395" y="185" width="30" height="30" class="cell walls-3 cell-exit"></rect><rect x="425" y="185" width="30" height="30" class="cell walls-12 cell-exit"></rect><rect x="455" y="185" width="30" height="30" class="cell walls-11"></rect><rect x="485" y="185" width="30" height="30" class="cell walls-10 cell-exit"></rect><rect x="515" y="185" width="30" height="30" class="cell walls-10 cell-exit"></rect><rect x="35" y="215" width="30" height="30" class="cell walls-10"></rect><rect x="65" y="215" width="30" height="30" class="cell walls-6"></rect><rect x="95" y="215" width="30" height="30" class="cell walls-5"></rect><rect x="125" y="215" width="30" height="30" class="cell walls-9"></rect><rect x="155" y="215" width="30" height="30" class="cell walls-3"></rect><rect x="185" y="215" width="30" height="30" class="cell walls-12"></rect><rect x="215" y="215" width="30" height="30" class="cell walls-3"></rect><rect x="245" y="215" width="30" height="30" class="cell walls-9"></rect><rect x="275" y="215" width="30" height="30" class="cell walls-3"></rect><rect x="305" y="215" width="30" height="30" class="cell walls-12"></rect><rect x="335" y="215" width="30" height="30" class="cell walls-3 cell-exit"></rect><rect x="365" y="215" width="30" height="30" class="cell walls-5 cell-exit"></rect><rect x="395" y="215" width="30" height="30" class="cell walls-12 cell-exit"></rect><rect x="425" y="215" width="30" height="30" class="cell walls-7"></rect><rect x="455" y="215" width="30" height="30" class="cell walls-4"></rect><rect x="485" y="215" width="30" height="30" class="cell walls-4 cell-exit"></rect><rect x="515" y="215" width="30" height="30" class="cell walls-12 cell-exit"></rect><rect x="35" y="245" width="30" height="30" class="cell walls-6"></rect><rect x="65" y="245" width="30" height="30" class="cell walls-5"></rect><rect x="95" y="245" width="30" height="30" class="cell walls-9"></rect><rect x="125" y="245" width="30" height="30" class="cell walls-10"></rect><rect x="155" y="245" width="30" height="30" class="cell walls-10"></rect><rect x="185" y="245" width="30" height="30" class="cell walls-3"></rect><rect x="215" y="245" width="30" height="30" class="cell walls-8"></rect><rect x="245" y="245" width="30" height="30" class="cell walls-14"></rect><rect x="275" y="245" width="30" height="30" class="cell walls-10"></rect><rect x="305" y="245" width="30" height="30" class="cell walls-7"></rect><rect x="335" y="245" width="30" height="30" class="cell walls-0 cell-exit"></rect><rect x="365" y="245" width="30" height="30" class="cell walls-9 cell-exit"></rect><rect x="395" y="245" width="30" height="30" class="cell walls-3 cell-exit"></rect><rect x="425" y="245" width="30" height="30" class="cell walls-5 cell-exit"></rect><rect x="455" y="245" width="30" height="30" class="cell walls-9 cell-exit"></rect><rect x="485" y="245" width="30" height="30" class="cell walls-3 cell-exit"></rect><rect x="515" y="245" width="30" height="30" class="cell walls-9 cell-exit"></rect><rect x="35" y="275" width="30" height="30" class="cell walls-3"></rect><rect x="65" y="275" width="30" height="30" class="cell walls-9"></rect><rect x="95" y="275" width="30" height="30" class="cell walls-10"></rect><rect x="125" y="275" width="30" height="30" class="cell walls-10"></rect><rect x="155" y="275" width="30" height="30" class="cell walls-10"></rect><rect x="185" y="275" width="30" height="30" class="cell walls-10"></rect><rect x="215" y="275" width="30" height="30" class="cell walls-6"></rect><rect x="245" y="275" width="30" height="30" class="cell walls-9"></rect><rect x="275" y="275" width="30" height="30" class="cell walls-6"></rect><rect x="305" y="275" width="30" height="30" class="cell walls-9"></rect><rect x="335" y="275" width="30" height="30" class="cell walls-10"></rect><rect x="365" y="275" width="30" height="30" class="cell walls-6 cell-exit"></rect><rect x="395" y="275" width="30" height="30" class="cell walls-4 cell-exit"></rect><rect x="425" y="275" width="30" height="30" class="cell walls-13"></rect><rect x="455" y="275" width="30" height="30" class="cell walls-2 cell-exit"></rect><rect x="485" y="275" width="30" height="30" class="cell walls-12 cell-exit"></rect><rect x="515" y="275" width="30" height="30" class="cell walls-10 cell-exit"></rect><rect x="35" y="305" width="30" height="30" class="cell walls-10"></rect><rect x="65" y="305" width="30" height="30" class="cell walls-6"></rect><rect x="95" y="305" width="30" height="30" class="cell walls-12"></rect><rect x="125" y="305" width="30" height="30" class="cell walls-6"></rect><rect x="155" y="305" width="30" height="30" class="cell walls-12"></rect><rect x="185" y="305" width="30" height="30" class="cell walls-10"></rect><rect x="215" y="305" width="30" height="30" class="cell walls-3"></rect><rect x="245" y="305" width="30" height="30" class="cell walls-12"></rect><rect x="275" y="305" width="30" height="30" class="cell walls-3"></rect><rect x="305" y="305" width="30" height="30" class="cell walls-12"></rect><rect x="335" y="305" width="30" height="30" class="cell walls-6"></rect><rect x="365" y="305" width="30" height="30" class="cell walls-13"></rect><rect x="395" y="305" width="30" height="30" class="cell walls-3"></rect><rect x="425" y="305" width="30" height="30" class="cell walls-9"></rect><rect x="455" y="305" width="30" height="30" class="cell walls-10"></rect><rect x="485" y="305" width="30" height="30" class="cell walls-3 cell-exit"></rect><rect x="515" y="305" width="30" height="30" class="cell walls-12 cell-exit"></rect><rect x="35" y="335" width="30" height="30" class="cell walls-2"></rect><rect x="65" y="335" width="30" height="30" class="cell walls-5"></rect><rect x="95" y="335" width="30" height="30" class="cell walls-5"></rect><rect x="125" y="335" width="30" height="30" class="cell walls-5"></rect><rect x="155" y="335" width="30" height="30" class="cell walls-5"></rect><rect x="185" y="335" width="30" height="30" class="cell walls-12"></rect><rect x="215" y="335" width="30" height="30" class="cell walls-6"></rect><rect x="245" y="335" width="30" height="30" class="cell walls-5"></rect><rect x="275" y="335" width="30" height="30" class="cell walls-12"></rect><rect x="305" y="335" width="30" height="30" class="cell walls-7"></rect><rect x="335" y="335" width="30" height="30" class="cell walls-1"></rect><rect x="365" y="335" width="30" height="30" class="cell walls-9"></rect><rect x="395" y="335" width="30" height="30" class="cell walls-10"></rect><rect x="425" y="335" width="30" height="30" class="cell walls-10"></rect><rect x="455" y="335" width="30" height="30" class="cell walls-14"></rect><rect x="485" y="335" width="30" height="30" class="cell walls-6 cell-exit"></rect><rect x="515" y="335" width="30" height="30" class="cell walls-9 cell-exit"></rect><rect x="35" y="365" width="30" height="30" class="cell walls-10"></rect><rect x="65" y="365" width="30" height="30" class="cell walls-3"></rect><rect x="95" y="365" width="30" height="30" class="cell walls-1"></rect><rect x="125" y="365" width="30" height="30" class="cell walls-5"></rect><rect x="155" y="365" width="30" height="30" class="cell walls-9"></rect><rect x="185" y="365" width="30" height="30" class="cell walls-7"></rect><rect x="215" y="365" width="30" height="30" class="cell walls-1"></rect><rect x="245" y="365" width="30" height="30" class="cell walls-5"></rect><rect x="275" y="365" width="30" height="30" class="cell walls-9"></rect><rect x="305" y="365" width="30" height="30" class="cell walls-3"></rect><rect x="335" y="365" width="30" height="30" class="cell walls-12"></rect><rect x="365" y="365" width="30" height="30" class="cell walls-6"></rect><rect x="395" y="365" width="30" height="30" class="cell walls-12"></rect><rect x="425" y="365" width="30" height="30" class="cell walls-6"></rect><rect x="455" y="365" width="30" height="30" class="cell walls-9"></rect><rect x="485" y="365" width="30" height="30" class="cell walls-3 cell-exit"></rect><rect x="515" y="365" width="30" height="30" class="cell walls-8 cell-exit"></rect><rect x="35" y="395" width="30" height="30" class="cell walls-10"></rect><rect x="65" y="395" width="30" height="30" class="cell walls-14"></rect><rect x="95" y="395" width="30" height="30" class="cell walls-10"></rect><rect x="125" y="395" width="30" height="30" class="cell walls-7"></rect><rect x="155" y="395" width="30" height="30" class="cell walls-4"></rect><rect x="185" y="395" width="30" height="30" class="cell walls-9"></rect><rect x="215" y="395" width="30" height="30" class="cell walls-10"></rect><rect x="245" y="395" width="30" height="30" class="cell walls-7"></rect><rect x="275" y="395" width="30" height="30" class="cell walls-8"></rect><rect x="305" y="395" width="30" height="30" class="cell walls-10"></rect><rect x="335" y="395" width="30" height="30" class="cell walls-3 cell-exit"></rect><rect x="365" y="395" width="30" height="30" class="cell walls-5 cell-exit"></rect><rect x="395" y="395" width="30" height="30" class="cell walls-1 cell-exit"></rect><rect x="425" y="395" width="30" height="30" class="cell walls-13"></rect><rect x="455" y="395" width="30" height="30" class="cell walls-10"></rect><rect x="485" y="395" width="30" height="30" class="cell walls-10 cell-exit"></rect><rect x="515" y="395" width="30" height="30" class="cell walls-10"></rect><rect x="35" y="425" width="30" height="30" class="cell walls-6"></rect><rect x="65" y="425" width="30" height="30" class="cell walls-9"></rect><rect x="95" y="425" width="30" height="30" class="cell walls-6"></rect><rect x="125" y="425" width="30" height="30" class="cell walls-9"></rect><rect x="155" y="425" width="30" height="30" class="cell walls-11"></rect><rect x="185" y="425" width="30" height="30" class="cell walls-10"></rect><rect x="215" y="425" width="30" height="30" class="cell walls-6"></rect><rect x="245" y="425" width="30" height="30" class="cell walls-9"></rect><rect x="275" y="425" width="30" height="30" class="cell walls-6"></rect><rect x="305" y="425" width="30" height="30" class="cell walls-12"></rect><rect x="335" y="425" width="30" height="30" class="cell walls-10 cell-exit"></rect><rect x="365" y="425" width="30" height="30" class="cell walls-11"></rect><rect x="395" y="425" width="30" height="30" class="cell walls-6 cell-exit"></rect><rect x="425" y="425" width="30" height="30" class="cell walls-9 cell-exit"></rect><rect x="455" y="425" width="30" height="30" class="cell walls-10"></rect><rect x="485" y="425" width="30" height="30" class="cell walls-10 cell-exit"></rect><rect x="515" y="425" width="30" height="30" class="cell walls-10"></rect><rect x="35" y="455" width="30" height="30" class="cell walls-7"></rect><rect x="65" y="455" width="30" height="30" class="cell walls-4"></rect><rect x="95" y="455" width="30" height="30" class="cell walls-5"></rect><rect x="125" y="455" width="30" height="30" class="cell walls-12"></rect><rect x="155" y="455" width="30" height="30" class="cell walls-6"></rect><rect x="185" y="455" width="30" height="30" class="cell walls-4"></rect><rect x="215" y="455" width="30" height="30" class="cell walls-5"></rect><rect x="245" y="455" width="30" height="30" class="cell walls-12"></rect><rect x="275" y="455" width="30" height="30" class="cell walls-7"></rect><rect x="305" y="455" width="30" height="30" class="cell walls-5"></rect><rect x="335" y="455" width="30" height="30" class="cell walls-4 cell-exit"></rect><rect x="365" y="455" width="30" height="30" class="cell walls-4"></rect><rect x="395" y="455" width="30" height="30" class="cell walls-13"></rect><rect x="425" y="455" width="30" height="30" class="cell walls-6 cell-exit"></rect><rect x="455" y="455" width="30" height="30" class="cell walls-4 cell-exit"></rect><rect x="485" y="455" width="30" height="30" class="cell walls-12 cell-exit"></rect><rect x="515" y="455" width="30" height="30" class="cell walls-14"></rect><text x="380" y="140" class="marker">E</text><text x="380" y="470" class="marker">P</text><text x="110" y="170" class="marker">D</text></svg>

Escape route (red)

<svg width="520" height="610"><text x="50" y="20" class="marker">0</text><text x="80" y="20" class="marker">1</text><text x="110" y="20" class="marker">2</text><text x="140" y="20" class="marker">3</text><text x="170" y="20" class="marker">4</text><text x="200" y="20" class="marker">5</text><text x="230" y="20" class="marker">6</text><text x="260" y="20" class="marker">7</text><text x="290" y="20" class="marker">8</text><text x="320" y="20" class="marker">9</text><text x="350" y="20" class="marker">10</text><text x="380" y="20" class="marker">11</text><text x="410" y="20" class="marker">12</text><text x="440" y="20" class="marker">13</text><text x="470" y="20" class="marker">14</text><text x="20" y="50" class="marker">0</text><text x="20" y="80" class="marker">1</text><text x="20" y="110" class="marker">2</text><text x="20" y="140" class="marker">3</text><text x="20" y="170" class="marker">4</text><text x="20" y="200" class="marker">5</text><text x="20" y="230" class="marker">6</text><text x="20" y="260" class="marker">7</text><text x="20" y="290" class="marker">8</text><text x="20" y="320" class="marker">9</text><text x="20" y="350" class="marker">10</text><text x="20" y="380" class="marker">11</text><text x="20" y="410" class="marker">12</text><text x="20" y="440" class="marker">13</text><text x="20" y="470" class="marker">14</text><text x="20" y="500" class="marker">15</text><text x="20" y="530" class="marker">16</text><text x="20" y="560" class="marker">17</text><rect x="35" y="35" width="30" height="30" class="cell walls-11 cell-escape"></rect><rect x="65" y="35" width="30" height="30" class="cell walls-11"></rect><rect x="95" y="35" width="30" height="30" class="cell walls-3"></rect><rect x="125" y="35" width="30" height="30" class="cell walls-5"></rect><rect x="155" y="35" width="30" height="30" class="cell walls-5"></rect><rect x="185" y="35" width="30" height="30" class="cell walls-5"></rect><rect x="215" y="35" width="30" height="30" class="cell walls-1"></rect><rect x="245" y="35" width="30" height="30" class="cell walls-9"></rect><rect x="275" y="35" width="30" height="30" class="cell walls-3"></rect><rect x="305" y="35" width="30" height="30" class="cell walls-5"></rect><rect x="335" y="35" width="30" height="30" class="cell walls-1"></rect><rect x="365" y="35" width="30" height="30" class="cell walls-9"></rect><rect x="395" y="35" width="30" height="30" class="cell walls-7"></rect><rect x="425" y="35" width="30" height="30" class="cell walls-1"></rect><rect x="455" y="35" width="30" height="30" class="cell walls-13"></rect><rect x="35" y="65" width="30" height="30" class="cell walls-10 cell-escape"></rect><rect x="65" y="65" width="30" height="30" class="cell walls-6"></rect><rect x="95" y="65" width="30" height="30" class="cell walls-8"></rect><rect x="125" y="65" width="30" height="30" class="cell walls-11"></rect><rect x="155" y="65" width="30" height="30" class="cell walls-3"></rect><rect x="185" y="65" width="30" height="30" class="cell walls-5"></rect><rect x="215" y="65" width="30" height="30" class="cell walls-12"></rect><rect x="245" y="65" width="30" height="30" class="cell walls-14"></rect><rect x="275" y="65" width="30" height="30" class="cell walls-6"></rect><rect x="305" y="65" width="30" height="30" class="cell walls-9"></rect><rect x="335" y="65" width="30" height="30" class="cell walls-10"></rect><rect x="365" y="65" width="30" height="30" class="cell walls-6"></rect><rect x="395" y="65" width="30" height="30" class="cell walls-9"></rect><rect x="425" y="65" width="30" height="30" class="cell walls-6"></rect><rect x="455" y="65" width="30" height="30" class="cell walls-9"></rect><rect x="35" y="95" width="30" height="30" class="cell walls-6 cell-escape"></rect><rect x="65" y="95" width="30" height="30" class="cell walls-9 cell-escape"></rect><rect x="95" y="95" width="30" height="30" class="cell walls-10"></rect><rect x="125" y="95" width="30" height="30" class="cell walls-10"></rect><rect x="155" y="95" width="30" height="30" class="cell walls-6"></rect><rect x="185" y="95" width="30" height="30" class="cell walls-5"></rect><rect x="215" y="95" width="30" height="30" class="cell walls-9"></rect><rect x="245" y="95" width="30" height="30" class="cell walls-3"></rect><rect x="275" y="95" width="30" height="30" class="cell walls-5"></rect><rect x="305" y="95" width="30" height="30" class="cell walls-12"></rect><rect x="335" y="95" width="30" height="30" class="cell walls-10"></rect><rect x="365" y="95" width="30" height="30" class="cell walls-11"></rect><rect x="395" y="95" width="30" height="30" class="cell walls-10"></rect><rect x="425" y="95" width="30" height="30" class="cell walls-3"></rect><rect x="455" y="95" width="30" height="30" class="cell walls-8"></rect><rect x="35" y="125" width="30" height="30" class="cell walls-11"></rect><rect x="65" y="125" width="30" height="30" class="cell walls-10 cell-escape"></rect><rect x="95" y="125" width="30" height="30" class="cell walls-6"></rect><rect x="125" y="125" width="30" height="30" class="cell walls-8"></rect><rect x="155" y="125" width="30" height="30" class="cell walls-7"></rect><rect x="185" y="125" width="30" height="30" class="cell walls-9"></rect><rect x="215" y="125" width="30" height="30" class="cell walls-10"></rect><rect x="245" y="125" width="30" height="30" class="cell walls-10"></rect><rect x="275" y="125" width="30" height="30" class="cell walls-11"></rect><rect x="305" y="125" width="30" height="30" class="cell walls-3"></rect><rect x="335" y="125" width="30" height="30" class="cell walls-8"></rect><rect x="365" y="125" width="30" height="30" class="cell walls-6"></rect><rect x="395" y="125" width="30" height="30" class="cell walls-4"></rect><rect x="425" y="125" width="30" height="30" class="cell walls-12"></rect><rect x="455" y="125" width="30" height="30" class="cell walls-10"></rect><rect x="35" y="155" width="30" height="30" class="cell walls-10"></rect><rect x="65" y="155" width="30" height="30" class="cell walls-6 cell-escape"></rect><rect x="95" y="155" width="30" height="30" class="cell walls-9 cell-escape"></rect><rect x="125" y="155" width="30" height="30" class="cell walls-10"></rect><rect x="155" y="155" width="30" height="30" class="cell walls-3"></rect><rect x="185" y="155" width="30" height="30" class="cell walls-12"></rect><rect x="215" y="155" width="30" height="30" class="cell walls-10"></rect><rect x="245" y="155" width="30" height="30" class="cell walls-10"></rect><rect x="275" y="155" width="30" height="30" class="cell walls-10"></rect><rect x="305" y="155" width="30" height="30" class="cell walls-10"></rect><rect x="335" y="155" width="30" height="30" class="cell walls-14"></rect><rect x="365" y="155" width="30" height="30" class="cell walls-3"></rect><rect x="395" y="155" width="30" height="30" class="cell walls-9"></rect><rect x="425" y="155" width="30" height="30" class="cell walls-11"></rect><rect x="455" y="155" width="30" height="30" class="cell walls-10"></rect><rect x="35" y="185" width="30" height="30" class="cell walls-2 cell-escape"></rect><rect x="65" y="185" width="30" height="30" class="cell walls-5 cell-escape"></rect><rect x="95" y="185" width="30" height="30" class="cell walls-12 cell-escape"></rect><rect x="125" y="185" width="30" height="30" class="cell walls-10"></rect><rect x="155" y="185" width="30" height="30" class="cell walls-6"></rect><rect x="185" y="185" width="30" height="30" class="cell walls-9"></rect><rect x="215" y="185" width="30" height="30" class="cell walls-6"></rect><rect x="245" y="185" width="30" height="30" class="cell walls-12"></rect><rect x="275" y="185" width="30" height="30" class="cell walls-10"></rect><rect x="305" y="185" width="30" height="30" class="cell walls-6"></rect><rect x="335" y="185" width="30" height="30" class="cell walls-5"></rect><rect x="365" y="185" width="30" height="30" class="cell walls-12"></rect><rect x="395" y="185" width="30" height="30" class="cell walls-10"></rect><rect x="425" y="185" width="30" height="30" class="cell walls-2"></rect><rect x="455" y="185" width="30" height="30" class="cell walls-12"></rect><rect x="35" y="215" width="30" height="30" class="cell walls-6 cell-escape"></rect><rect x="65" y="215" width="30" height="30" class="cell walls-9 cell-escape"></rect><rect x="95" y="215" width="30" height="30" class="cell walls-11"></rect><rect x="125" y="215" width="30" height="30" class="cell walls-6"></rect><rect x="155" y="215" width="30" height="30" class="cell walls-1"></rect><rect x="185" y="215" width="30" height="30" class="cell walls-4"></rect><rect x="215" y="215" width="30" height="30" class="cell walls-5"></rect><rect x="245" y="215" width="30" height="30" class="cell walls-5"></rect><rect x="275" y="215" width="30" height="30" class="cell walls-4"></rect><rect x="305" y="215" width="30" height="30" class="cell walls-5"></rect><rect x="335" y="215" width="30" height="30" class="cell walls-13"></rect><rect x="365" y="215" width="30" height="30" class="cell walls-3"></rect><rect x="395" y="215" width="30" height="30" class="cell walls-12"></rect><rect x="425" y="215" width="30" height="30" class="cell walls-10"></rect><rect x="455" y="215" width="30" height="30" class="cell walls-11"></rect><rect x="35" y="245" width="30" height="30" class="cell walls-3 cell-escape"></rect><rect x="65" y="245" width="30" height="30" class="cell walls-12 cell-escape"></rect><rect x="95" y="245" width="30" height="30" class="cell walls-2"></rect><rect x="125" y="245" width="30" height="30" class="cell walls-5"></rect><rect x="155" y="245" width="30" height="30" class="cell walls-12"></rect><rect x="185" y="245" width="30" height="30" class="cell walls-3"></rect><rect x="215" y="245" width="30" height="30" class="cell walls-9"></rect><rect x="245" y="245" width="30" height="30" class="cell walls-3"></rect><rect x="275" y="245" width="30" height="30" class="cell walls-5"></rect><rect x="305" y="245" width="30" height="30" class="cell walls-5"></rect><rect x="335" y="245" width="30" height="30" class="cell walls-9"></rect><rect x="365" y="245" width="30" height="30" class="cell walls-6"></rect><rect x="395" y="245" width="30" height="30" class="cell walls-9"></rect><rect x="425" y="245" width="30" height="30" class="cell walls-10"></rect><rect x="455" y="245" width="30" height="30" class="cell walls-10"></rect><rect x="35" y="275" width="30" height="30" class="cell walls-6 cell-escape"></rect><rect x="65" y="275" width="30" height="30" class="cell walls-9 cell-escape"></rect><rect x="95" y="275" width="30" height="30" class="cell walls-10"></rect><rect x="125" y="275" width="30" height="30" class="cell walls-11"></rect><rect x="155" y="275" width="30" height="30" class="cell walls-3"></rect><rect x="185" y="275" width="30" height="30" class="cell walls-12"></rect><rect x="215" y="275" width="30" height="30" class="cell walls-6"></rect><rect x="245" y="275" width="30" height="30" class="cell walls-12"></rect><rect x="275" y="275" width="30" height="30" class="cell walls-3"></rect><rect x="305" y="275" width="30" height="30" class="cell walls-5"></rect><rect x="335" y="275" width="30" height="30" class="cell walls-4"></rect><rect x="365" y="275" width="30" height="30" class="cell walls-5"></rect><rect x="395" y="275" width="30" height="30" class="cell walls-12"></rect><rect x="425" y="275" width="30" height="30" class="cell walls-6"></rect><rect x="455" y="275" width="30" height="30" class="cell walls-8"></rect><rect x="35" y="305" width="30" height="30" class="cell walls-11"></rect><rect x="65" y="305" width="30" height="30" class="cell walls-10 cell-escape"></rect><rect x="95" y="305" width="30" height="30" class="cell walls-2"></rect><rect x="125" y="305" width="30" height="30" class="cell walls-12"></rect><rect x="155" y="305" width="30" height="30" class="cell walls-10"></rect><rect x="185" y="305" width="30" height="30" class="cell walls-3"></rect><rect x="215" y="305" width="30" height="30" class="cell walls-9"></rect><rect x="245" y="305" width="30" height="30" class="cell walls-3"></rect><rect x="275" y="305" width="30" height="30" class="cell walls-12"></rect><rect x="305" y="305" width="30" height="30" class="cell walls-3 cell-escape"></rect><rect x="335" y="305" width="30" height="30" class="cell walls-5 cell-escape"></rect><rect x="365" y="305" width="30" height="30" class="cell walls-5 cell-escape"></rect><rect x="395" y="305" width="30" height="30" class="cell walls-9 cell-escape"></rect><rect x="425" y="305" width="30" height="30" class="cell walls-3"></rect><rect x="455" y="305" width="30" height="30" class="cell walls-12"></rect><rect x="35" y="335" width="30" height="30" class="cell walls-2 cell-escape"></rect><rect x="65" y="335" width="30" height="30" class="cell walls-12 cell-escape"></rect><rect x="95" y="335" width="30" height="30" class="cell walls-14"></rect><rect x="125" y="335" width="30" height="30" class="cell walls-3"></rect><rect x="155" y="335" width="30" height="30" class="cell walls-12"></rect><rect x="185" y="335" width="30" height="30" class="cell walls-14"></rect><rect x="215" y="335" width="30" height="30" class="cell walls-6"></rect><rect x="245" y="335" width="30" height="30" class="cell walls-4"></rect><rect x="275" y="335" width="30" height="30" class="cell walls-13"></rect><rect x="305" y="335" width="30" height="30" class="cell walls-10 cell-escape"></rect><rect x="335" y="335" width="30" height="30" class="cell walls-3 cell-escape"></rect><rect x="365" y="335" width="30" height="30" class="cell walls-5 cell-escape"></rect><rect x="395" y="335" width="30" height="30" class="cell walls-12 cell-escape"></rect><rect x="425" y="335" width="30" height="30" class="cell walls-6"></rect><rect x="455" y="335" width="30" height="30" class="cell walls-9"></rect><rect x="35" y="365" width="30" height="30" class="cell walls-6 cell-escape"></rect><rect x="65" y="365" width="30" height="30" class="cell walls-5 cell-escape"></rect><rect x="95" y="365" width="30" height="30" class="cell walls-9 cell-escape"></rect><rect x="125" y="365" width="30" height="30" class="cell walls-6"></rect><rect x="155" y="365" width="30" height="30" class="cell walls-5"></rect><rect x="185" y="365" width="30" height="30" class="cell walls-9"></rect><rect x="215" y="365" width="30" height="30" class="cell walls-3 cell-escape"></rect><rect x="245" y="365" width="30" height="30" class="cell walls-5 cell-escape"></rect><rect x="275" y="365" width="30" height="30" class="cell walls-5 cell-escape"></rect><rect x="305" y="365" width="30" height="30" class="cell walls-12 cell-escape"></rect><rect x="335" y="365" width="30" height="30" class="cell walls-10 cell-escape"></rect><rect x="365" y="365" width="30" height="30" class="cell walls-3"></rect><rect x="395" y="365" width="30" height="30" class="cell walls-9"></rect><rect x="425" y="365" width="30" height="30" class="cell walls-3"></rect><rect x="455" y="365" width="30" height="30" class="cell walls-12"></rect><rect x="35" y="395" width="30" height="30" class="cell walls-3 cell-escape"></rect><rect x="65" y="395" width="30" height="30" class="cell walls-5 cell-escape"></rect><rect x="95" y="395" width="30" height="30" class="cell walls-12 cell-escape"></rect><rect x="125" y="395" width="30" height="30" class="cell walls-3 cell-escape"></rect><rect x="155" y="395" width="30" height="30" class="cell walls-9 cell-escape"></rect><rect x="185" y="395" width="30" height="30" class="cell walls-10"></rect><rect x="215" y="395" width="30" height="30" class="cell walls-6"></rect><rect x="245" y="395" width="30" height="30" class="cell walls-9"></rect><rect x="275" y="395" width="30" height="30" class="cell walls-3"></rect><rect x="305" y="395" width="30" height="30" class="cell walls-9"></rect><rect x="335" y="395" width="30" height="30" class="cell walls-10 cell-escape"></rect><rect x="365" y="395" width="30" height="30" class="cell walls-10"></rect><rect x="395" y="395" width="30" height="30" class="cell walls-10"></rect><rect x="425" y="395" width="30" height="30" class="cell walls-10"></rect><rect x="455" y="395" width="30" height="30" class="cell walls-11"></rect><rect x="35" y="425" width="30" height="30" class="cell walls-10 cell-escape"></rect><rect x="65" y="425" width="30" height="30" class="cell walls-7"></rect><rect x="95" y="425" width="30" height="30" class="cell walls-1 cell-escape"></rect><rect x="125" y="425" width="30" height="30" class="cell walls-12 cell-escape"></rect><rect x="155" y="425" width="30" height="30" class="cell walls-10 cell-escape"></rect><rect x="185" y="425" width="30" height="30" class="cell walls-10"></rect><rect x="215" y="425" width="30" height="30" class="cell walls-3"></rect><rect x="245" y="425" width="30" height="30" class="cell walls-12"></rect><rect x="275" y="425" width="30" height="30" class="cell walls-10"></rect><rect x="305" y="425" width="30" height="30" class="cell walls-10"></rect><rect x="335" y="425" width="30" height="30" class="cell walls-10 cell-escape"></rect><rect x="365" y="425" width="30" height="30" class="cell walls-14"></rect><rect x="395" y="425" width="30" height="30" class="cell walls-10"></rect><rect x="425" y="425" width="30" height="30" class="cell walls-6"></rect><rect x="455" y="425" width="30" height="30" class="cell walls-8"></rect><rect x="35" y="455" width="30" height="30" class="cell walls-10 cell-escape"></rect><rect x="65" y="455" width="30" height="30" class="cell walls-3 cell-escape"></rect><rect x="95" y="455" width="30" height="30" class="cell walls-12 cell-escape"></rect><rect x="125" y="455" width="30" height="30" class="cell walls-11"></rect><rect x="155" y="455" width="30" height="30" class="cell walls-10 cell-escape"></rect><rect x="185" y="455" width="30" height="30" class="cell walls-6"></rect><rect x="215" y="455" width="30" height="30" class="cell walls-4"></rect><rect x="245" y="455" width="30" height="30" class="cell walls-1"></rect><rect x="275" y="455" width="30" height="30" class="cell walls-12"></rect><rect x="305" y="455" width="30" height="30" class="cell walls-14"></rect><rect x="335" y="455" width="30" height="30" class="cell walls-6 cell-escape"></rect><rect x="365" y="455" width="30" height="30" class="cell walls-9 cell-escape"></rect><rect x="395" y="455" width="30" height="30" class="cell walls-6"></rect><rect x="425" y="455" width="30" height="30" class="cell walls-9"></rect><rect x="455" y="455" width="30" height="30" class="cell walls-10"></rect><rect x="35" y="485" width="30" height="30" class="cell walls-6 cell-escape"></rect><rect x="65" y="485" width="30" height="30" class="cell walls-12 cell-escape"></rect><rect x="95" y="485" width="30" height="30" class="cell walls-3"></rect><rect x="125" y="485" width="30" height="30" class="cell walls-12"></rect><rect x="155" y="485" width="30" height="30" class="cell walls-6 cell-escape"></rect><rect x="185" y="485" width="30" height="30" class="cell walls-9 cell-escape"></rect><rect x="215" y="485" width="30" height="30" class="cell walls-3"></rect><rect x="245" y="485" width="30" height="30" class="cell walls-12"></rect><rect x="275" y="485" width="30" height="30" class="cell walls-3 cell-escape"></rect><rect x="305" y="485" width="30" height="30" class="cell walls-5 cell-escape"></rect><rect x="335" y="485" width="30" height="30" class="cell walls-9 cell-escape"></rect><rect x="365" y="485" width="30" height="30" class="cell walls-2 cell-escape"></rect><rect x="395" y="485" width="30" height="30" class="cell walls-9 cell-escape"></rect><rect x="425" y="485" width="30" height="30" class="cell walls-6"></rect><rect x="455" y="485" width="30" height="30" class="cell walls-8"></rect><rect x="35" y="515" width="30" height="30" class="cell walls-3 cell-escape"></rect><rect x="65" y="515" width="30" height="30" class="cell walls-5 cell-escape"></rect><rect x="95" y="515" width="30" height="30" class="cell walls-4 cell-escape"></rect><rect x="125" y="515" width="30" height="30" class="cell walls-5 cell-escape"></rect><rect x="155" y="515" width="30" height="30" class="cell walls-5 cell-escape"></rect><rect x="185" y="515" width="30" height="30" class="cell walls-12 cell-escape"></rect><rect x="215" y="515" width="30" height="30" class="cell walls-14"></rect><rect x="245" y="515" width="30" height="30" class="cell walls-3 cell-escape"></rect><rect x="275" y="515" width="30" height="30" class="cell walls-12 cell-escape"></rect><rect x="305" y="515" width="30" height="30" class="cell walls-3 cell-escape"></rect><rect x="335" y="515" width="30" height="30" class="cell walls-12 cell-escape"></rect><rect x="365" y="515" width="30" height="30" class="cell walls-14"></rect><rect x="395" y="515" width="30" height="30" class="cell walls-6 cell-escape"></rect><rect x="425" y="515" width="30" height="30" class="cell walls-9 cell-escape"></rect><rect x="455" y="515" width="30" height="30" class="cell walls-10"></rect><rect x="35" y="545" width="30" height="30" class="cell walls-6 cell-escape"></rect><rect x="65" y="545" width="30" height="30" class="cell walls-5 cell-escape"></rect><rect x="95" y="545" width="30" height="30" class="cell walls-5 cell-escape"></rect><rect x="125" y="545" width="30" height="30" class="cell walls-5 cell-escape"></rect><rect x="155" y="545" width="30" height="30" class="cell walls-5 cell-escape"></rect><rect x="185" y="545" width="30" height="30" class="cell walls-5 cell-escape"></rect><rect x="215" y="545" width="30" height="30" class="cell walls-5 cell-escape"></rect><rect x="245" y="545" width="30" height="30" class="cell walls-12 cell-escape"></rect><rect x="275" y="545" width="30" height="30" class="cell walls-7"></rect><rect x="305" y="545" width="30" height="30" class="cell walls-4 cell-escape"></rect><rect x="335" y="545" width="30" height="30" class="cell walls-5 cell-escape"></rect><rect x="365" y="545" width="30" height="30" class="cell walls-5 cell-escape"></rect><rect x="395" y="545" width="30" height="30" class="cell walls-5 cell-escape"></rect><rect x="425" y="545" width="30" height="30" class="cell walls-12 cell-escape"></rect><rect x="455" y="545" width="30" height="30" class="cell walls-14"></rect><text x="350" y="170" class="marker">E</text><text x="230" y="410" class="marker">P</text><text x="260" y="440" class="marker">D</text></svg>
    
## Solution

The code for solving maze problem resides in package [dashthroughmaze](https://github.com/alexvish/ponychallenge-trustpilot/tree/master/src/dashthroughmaze).
This package contains jest unit tests, including [TestDash.test.ts](https://github.com/alexvish/ponychallenge-trustpilot/blob/master/src/dashthroughmaze/__tests__/TestDash.test.ts) that actually plays the game, talking to trustpilot api server.

Execute tests with:

```sh
# In the root directory of cloned git repository https://github.com/alexvish/ponychallenge-trustpilot.git
$ npm install
$ npm run test
```

### Code

[dash.ts](https://github.com/alexvish/ponychallenge-trustpilot/blob/master/src/dashthroughmaze/dash.ts) contains the code that is used to work with mazes.

It contains definitions of Trustpilot api objects, and class `Maze`, that actually works with mazes.

In constructor of `Maze` trustpilot's wierd flat maze structure converted into two dimensional maze array, each cell is defined by number which is an or bitmask of these locations of walls:

```typescript
export const TOP=1;
export const LEFT=2;
export const BOTTOM=4;
export const RIGHT=8;
```

Method `Maze.possibleMoveLocations(p:Point)` returns an array of cell points, which are reachable from the point provided as argument.
This method determines edges in a cell graph.

Method `Maze.exitPath(p)` calculates `exitPath`, using depth first search through the cell graph. Maze define non-directional cell graph (A->B === B->A), so there is no need to use 
white-gray-black node marks when executing dfs search (if maze contained directional semi-transparent walls, we would be needed to use it). 

Thus, dfs search is very simple in our case, we only need to mark cells as visited (white-black) apporach.

Here is the code for calculating exit path: 


```typescript
  exitPath():Point[] {
    return this.dfsExitPath(this.pony, {currentPath:[], visitedCells:{}}) || [];
  }
  
  /*
   
   interface DfsContext {
     currentPath: Point[];
     visitedCells:{
       [pointStringKey: string]: boolean /*always true*/;
     };
   }

  */
  
  dfsExitPath (p: Point, dfsContext: DfsContext ): Point[] | undefined {
    // mark current visited
    dfsContext.visitedCells[toStringKey(p)] = true;
    // push current to path
    dfsContext.currentPath.push(p);

    if (eqPoint(p, this.exit)) {
      // found exit
      return dfsContext.currentPath.slice(0); // clone array
    }
    let reachable: Point[] = this.possibleMoveLocations(p);
    // filter out visited
    reachable = reachable.filter(nextP => !dfsContext.visitedCells[toStringKey(nextP)]);
    for (let next of reachable) {
      let path = this.dfsExitPath(next,dfsContext);
      if (path) {
        return path;
      }
    }
    // remove point from current path
    dfsContext.currentPath.pop();
    return undefined;
  }

```

During the pony move, and when calculating escape route we use method `Maze.isDomokunNearPoint(p: Point): boolean` to find out whether Domockun is either in the point or point is within one-step reach of Domokun.

Escape route is calculated in method `Maze.escapeRute(): Point[]`, using the following apporach:

1. Start with a path, that contains only pony location. Create array of paths for step 0 and puth this single path.
2. For each paths from prevous step, derive paths, that can be created by moving further. Add all found paths to array of paths for this step.
3. If array of paths for step is empty, use first path from array of paths of previous step.

## Web application

First of all, creation of web applicaiton was never a requirement, I spent a lot of effort to do it. The jest test runner is more then enough.

Trustpilot API does not provide [CORS](https://en.wikipedia.org/wiki/Cross-origin_resource_sharing) headers, so it is not possible to talk to API directly from browser,
unless you are Trustpilot employee and can deploy app to trustpilot server.

So, simple api proxy has been developed, using express, that adds CORS headers to API responses. Start proxy as follows:

```sh
# In the root directory of cloned git repository https://github.com/alexvish/ponychallenge-trustpilot.git

# Execute npm install
$ npm install

# Start api proxy
$ npm run proxy

```

After proxy is started, switch to Proxy page, click "Test" button, then switch to Play page, fill in game form and start game. 
Games can be run in step-by-step or autoplay modes.
There are surprise URLs from trustpilot, when you win or loose.

### Lessons learned when developing this web applicaitons.

#### Typescript

I mostly use typescript, but still do not understand whether it is good or evil. It helps you a little, and hits you sometimes, but not too hard. I think I'd stick to it for a while.

#### Storybooks

[Storybooks](https://storybook.js.org) are mega-useful, for UI component development. You basically start your components in isolation within storybook page until it is ready for integration with the rest of components.

Run storybooks for this project:

```sh

$ npm run storybook

# open browser on http://localhost:6006/

``` 

#### Animation

[React-motion](https://github.com/chenglou/react-motion) is the most easy to use package for animation. 
I went to react-motion when I had memory problems with another package I used for animation: my storybook entry crashed after a while. When switched to react-motion problems went away.

#### Redux-saga

Trustpilot API is tricky for consumption by web applicaiton, because you need to chain api requests. (E.g. with first request you move pony, with second get new domokun location)
This is where [redux-saga](https://redux-saga.js.org/) comes extremely handy: it allows to define chains of async executions in javascript, 
 using generator function syntax (function* yield and yield*). For example check saga `function* move(action: NextMoveAction)` 
 defined in [src/reducer/play.ts](https://github.com/alexvish/ponychallenge-trustpilot/tree/master/src/reducer/play.ts).

#### Server side rendering

There are no fancy SSR requirements for this application, but I want this exact page, that you are reading right now to be easily indexed by google and other crawlers. So, I implemented SSR for index route in compile time using webpack and [static site generator webpack plugin](https://github.com/markdalgleish/static-site-generator-webpack-plugin ). I could not find a clean recepie on internet on how to implement it, so I probably need to blog about this solution. 
